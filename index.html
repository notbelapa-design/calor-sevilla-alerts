<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CalorSevilla - Heatwave Alerts & Cooling Centers</title>
<style>
body { font-family: Arial, sans-serif; margin:0; padding:0; background:#f9f9f9; color:#333; }
header { background:#e64a19; color:#fff; padding:20px; text-align:center; }
h1 { margin:0; font-size:2rem; }
section { padding:20px; margin-bottom:20px; }
.card { background:#fff; border-radius:8px; padding:15px; margin:10px 0; box-shadow:0 2px 5px rgba(0,0,0,0.1); }
button { background:#e64a19; color:#fff; border:none; padding:10px 20px; font-size:1rem; border-radius:4px; cursor:pointer; }
button:hover { opacity:0.9; }
.list-item { display:flex; justify-content:space-between; align-items:center; flex-wrap:wrap; }
.list-item h3 { margin:0; }
.tip { background:#fff3e0; padding:10px; border-left:4px solid #ffa726; margin-bottom:8px; }
.footer { background:#f5f5f5; text-align:center; padding:15px; font-size:0.9rem; color:#777; }
.highlight { background:#ffe082; }
</style>
</head>
<body>
<header>
<h1>CalorSevilla</h1>
<p>Protect yourself from Seville's heatwaves</p>
</header>

<section id="intro">
<div class="card">
<p><strong>CalorSevilla</strong> brings together local heatwave alerts, free cooling spaces, and safety tips in one place. Seville is the first city in the world to name and categorize heatwaves. The pilot project includes three categories and alerts residents up to five days in advance. Our mission is to make these alerts accessible and actionable for everyone.</p>
</div>
</section>

<section id="alerts">
<h2>Today's Heatwave Status</h2>
<div class="card" id="heatStatus">
<p id="statusMessage">Fetching data...</p>
</div>
<p>This app uses Seville's heatwave categorization. If a Category 3 heatwave is active, it will be named (e.g., Zoe, Yago, Xenia). Stay informed!</p>
</section>

<section id="free-spots">
<h2>Cooling Centers & Hydration Spots</h2>
<div class="card">
<p>Here are some public places in Seville where you can cool down or hydrate during extreme heat. Click on each location to get directions.</p>
<div id="locationsList"></div>
<button onclick="sortByDistance()">Find nearest spots</button>
</div>
</section>

<section id="tips">
<h2>Heat Safety Tips</h2>
<div class="tip">Stay hydrated: drink water regularly, even if you don't feel thirsty.</div>
<div class="tip">Avoid strenuous outdoor activities during the hottest hours (12:00-18:00).</div>
<div class="tip">Wear light, breathable clothing and a hat.</div>
<div class="tip">Check on elderly neighbors and relatives.</div>
<div class="tip">Never leave children or pets in parked cars.</div>
</section>

<section id="subscribe">
<h2>Get Personalized Alerts</h2>
<div class="card">
<p>Upgrade to <strong>CalorSevilla Premium</strong> for €4.99/month to receive personalized SMS/email alerts based on your neighborhood, access micro-climate forecasts, and get discounts on cooling equipment.</p>
<p><a href="mailto:info@calorsevilla.com?subject=Join CalorSevilla Premium">Join now</a></p>
<p>Have questions? <a href="mailto:info@calorsevilla.com">Contact us</a></p>
</div>
</section>

<div class="footer">
<p>&copy; 2025 CalorSevilla. Data sources: Ayuntamiento de Sevilla, AEMET. This is a prototype and does not provide real-time health advice.</p>
</div>

<script>
const spots = [
  { name: "Biblioteca Infanta Elena", lat: 37.3710, lon: -5.9813 },
  { name: "Biblioteca Alberto Lista", lat: 37.3901, lon: -5.9872 },
  { name: "Biblioteca San Julián", lat: 37.3955, lon: -5.9819 },
  { name: "Centro Comercial Los Arcos", lat: 37.3859, lon: -5.9671 },
  { name: "Nervión Plaza", lat: 37.3830, lon: -5.9738 },
  { name: "Parque de María Luisa", lat: 37.3719, lon: -5.9896 }
];

function renderList(list) {
  const listContainer = document.getElementById("locationsList");
  listContainer.innerHTML = "";
  list.forEach(item => {
    const div = document.createElement("div");
    div.className = "list-item";
    const h3 = document.createElement("h3");
    h3.textContent = item.name;
    const link = document.createElement("a");
    link.href = "https://www.google.com/maps/search/?api=1&query=" + item.lat + "," + item.lon;
    link.target = "_blank";
    link.textContent = "Map";
    div.appendChild(h3);
    div.appendChild(link);
    listContainer.appendChild(div);
  });
}

function haversine(lat1, lon1, lat2, lon2) {
  const R = 6371;
  const toRad = deg => deg * Math.PI / 180;
  const dLat = toRad(lat2 - lat1);
  const dLon = toRad(lon2 - lon1);
  const a = Math.sin(dLat/2) * Math.sin(dLat/2) + Math.cos(toRad(lat1)) * Math.cos(toRad(lat2)) * Math.sin(dLon/2) * Math.sin(dLon/2);
  return R * 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));
}

function sortByDistance() {
  if (navigator.geolocation) {
    navigator.geolocation.getCurrentPosition(pos => {
      const userLat = pos.coords.latitude;
      const userLon = pos.coords.longitude;
      const sorted = spots.slice().sort((a, b) => {
        return haversine(userLat, userLon, a.lat, a.lon) - haversine(userLat, userLon, b.lat, b.lon);
      });
      renderList(sorted);
    }, () => {
      renderList(spots);
    });
  } else {
    renderList(spots);
  }
}

function updateHeatStatus() {
  const statusElement = document.getElementById("statusMessage");
  const categories = [
    { category: "No heatwave", message: "Temperatures are normal. Enjoy your day and stay hydrated." },
    { category: "Category 1", message: "Elevated temperatures. Take precautions like limiting outdoor activities." },
    { category: "Category 2", message: "Extreme heat. Seek shade, drink water, and check on vulnerable people." },
    { category: "Category 3: Zoe", message: "Severe heat event named Zoe. Follow official guidance, stay indoors if possible." }
  ];
  const selected = categories[Math.floor(Math.random() * categories.length)];
  statusElement.innerHTML = "<strong>" + selected.category + "</strong><br>" + selected.message;
  const card = document.getElementById("heatStatus");
  if (selected.category.indexOf("Category 3") !== -1) {
    card.classList.add("highlight");
  } else {
    card.classList.remove("highlight");
  }
}

renderList(spots);
updateHeatStatus();
</script>

</body>
</html>
